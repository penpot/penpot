// This Source Code Form is subject to the terms of the Mozilla Public
// License, v. 2.0. If a copy of the MPL was not distributed with this
// file, You can obtain one at http://mozilla.org/MPL/2.0/.
//
// Copyright (c) KALEIDOS INC

@use "ds/colors.scss" as *;
@use "ds/_sizes.scss" as *;
@use "ds/_borders.scss" as *;
@use "ds/spacing.scss" as *;

$switcher-sm-track-width: $sz-32;
$switcher-sm-track-height: $sz-16;
$switcher-sm-thumb-size: $sz-12;

$switcher-md-track-width: $sz-40;
$switcher-md-track-height: $sz-24;
$switcher-md-thumb-size: $sz-16;

$switcher-lg-track-width: $sz-48;
$switcher-lg-track-height: $sz-28;
$switcher-lg-thumb-size: $sz-24;

$switcher-transition-duration: 0.2s;

.switcher-wrapper {
  --switcher-track-outline: none;
  --switcher-track-outline-offset: 0;
  
  display: flex;
  align-items: center;
  gap: var(--sp-s);
  padding: 0;
  
  &:focus-visible {
    --switcher-track-outline: $b-2 solid var(--color-accent-primary);
    --switcher-track-outline-offset: #{$b-2};
  }
}

.switcher-label {
  --switcher-label-color: var(--color-foreground-secondary);
  
  color: var(--switcher-label-color);
  cursor: pointer;
  user-select: none;
}

.switcher-label-disabled {
  cursor: not-allowed;
  color: var(--color-foreground-secondary);
}

.switcher {
  --switcher-track-width: #{$switcher-md-track-width};
  --switcher-track-height: #{$switcher-md-track-height};
  --switcher-thumb-size: #{$switcher-md-thumb-size};
  --switcher-thumb-transform: translateX(0);
  --switcher-track-bg: var(--color-background-quaternary);
  --switcher-thumb-bg: var(--color-foreground-secondary);
  --switcher-thumb-shadow: 0 1px 3px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.06);
  
  position: relative;
  display: inline-block;
  cursor: pointer;
  outline: none;
  border: none;
  background: transparent;
  padding: 0;
  
  &:hover:not(.switcher-disabled) {
    --switcher-thumb-bg: var(--color-foreground-primary);
  }
}

// Size variants - Small
.switcher-sm {
  --switcher-track-width: #{$switcher-sm-track-width};
  --switcher-track-height: #{$switcher-sm-track-height};
  --switcher-thumb-size: #{$switcher-sm-thumb-size};
}

// Size variants - Medium (default)
.switcher-md {
  --switcher-track-width: #{$switcher-md-track-width};
  --switcher-track-height: #{$switcher-md-track-height};
  --switcher-thumb-size: #{$switcher-md-thumb-size};
}

// Size variants - Large
.switcher-lg {
  --switcher-track-width: #{$switcher-lg-track-width};
  --switcher-track-height: #{$switcher-lg-track-height};
  --switcher-thumb-size: #{$switcher-lg-thumb-size};
}

// Checked state
.switcher-checked {
  --switcher-track-bg: var(--color-accent-success);
  --switcher-thumb-bg: var(--color-foreground-primary);
  --switcher-thumb-shadow: 0 2px 4px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.08);
  
  &:hover:not(.switcher-disabled) {
    --switcher-track-bg: var(--color-accent-tertiary);
  }
}

.switcher-checked.switcher-sm {
  --switcher-thumb-transform: translateX(calc(#{$switcher-sm-track-width} - #{$switcher-sm-track-height}));
}

.switcher-checked.switcher-md {
  --switcher-thumb-transform: translateX(calc(#{$switcher-md-track-width} - #{$switcher-md-track-height}));
}

.switcher-checked.switcher-lg {
  --switcher-thumb-transform: translateX(calc(#{$switcher-lg-track-width} - #{$switcher-lg-track-height}));
}

// Disabled state
.switcher-disabled {
  cursor: not-allowed;
  
  &:not(.switcher-checked) {
    --switcher-track-bg: var(--color-background-tertiary);
    --switcher-thumb-bg: var(--color-foreground-secondary);
  }
}

.switcher-disabled.switcher-checked {
  --switcher-track-bg: var(--color-background-quaternary);
  --switcher-thumb-bg: var(--color-foreground-secondary);
}

.switcher-track {
  position: relative;
  width: var(--switcher-track-width);
  height: var(--switcher-track-height);
  border-radius: $br-full;
  background-color: var(--switcher-track-bg);
  transition: background-color $switcher-transition-duration ease-in-out;
  outline: var(--switcher-track-outline);
  outline-offset: var(--switcher-track-outline-offset);
}

.switcher-track-disabled {
  opacity: 0.6;
}

.switcher-thumb {
  position: absolute;
  width: var(--switcher-thumb-size);
  height: var(--switcher-thumb-size);
  top: calc((var(--switcher-track-height) - var(--switcher-thumb-size)) / 2);
  left: calc((var(--switcher-track-height) - var(--switcher-thumb-size)) / 2);
  border-radius: 50%;
  background-color: var(--switcher-thumb-bg);
  box-shadow: var(--switcher-thumb-shadow);
  transform: var(--switcher-thumb-transform);
  transition: transform $switcher-transition-duration ease-in-out, background-color $switcher-transition-duration ease-in-out;
}

.switcher-thumb-disabled {
  opacity: 0.5;
}

@media (prefers-reduced-motion: reduce) {
  .switcher-track,
  .switcher-thumb {
    transition: none;
  }
}

// Light mode color overrides
:global(.light) {
  .switcher {
    --switcher-track-bg: var(--color-background-secondary);
    --switcher-thumb-bg: var(--color-foreground-secondary);
  }
  
  .switcher-checked {
    --switcher-track-bg: var(--color-accent-primary-muted);
    --switcher-thumb-bg: var(--color-background-default);

    &:hover {
      --switcher-thumb-bg: var(--color-background-default);
    }
  }
}
