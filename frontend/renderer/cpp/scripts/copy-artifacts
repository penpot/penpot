#!/bin/bash
mkdir -p ../../resources/public/js/renderer/cpp
mkdir -p ../../src/app/renderer/

# FIXME: This is a VERY HACKY way to set the correct `scriptDirectory` but
# I didn't find a better way yet.
PREAMBLE_LINES=`wc -l js/preamble.js | egrep -o [0-9]+`
POSTAMBLE_LINES=`wc -l js/postamble.js | egrep -o [0-9]+`
LINE_NUMBER=`echo "200 + ${PREAMBLE_LINES} + ${POSTAMBLE_LINES}" | bc | egrep -o [0-9]+`
sed "${LINE_NUMBER} i \ \ scriptDirectory += 'renderer/cpp/';" out/renderer.js > ../../src/app/renderer/cpp.js
cp out/renderer.wasm ../../resources/public/js/renderer/cpp
