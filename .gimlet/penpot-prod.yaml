app: penpot
env: prod
namespace: penpot
deploy:
  branch: token-studio-develop
  event: push
chart:
  name: https://github.com/tokens-studio/tokens-studio-for-penpot.git?branch={{ .BRANCH }}&path=/.gimlet/k8s/penpot/
values:
  redis:
    replica:
      replicaCount: 0
  global:
    redisEnabled: true
    imagePullSecrets: 
      - name: ghcr-login-secret
  postgresql:
    enabled: true
    owner: penpot
    database: penpot
    # Assumed specified in infra
    secret: db-penpot-secrets
    superUser: db-penpot-superuser-secret
  config:
    assets:
      storageBackend: assets-s3
      s3:
        bucket: assets
        endpointURI: http://minio.penpot.svc.cluster.local:80
        existingSecret: 
          penpot-assets-user-0
        secretKeys:
          accessKeyIDKey: CONSOLE_ACCESS_KEY
          secretAccessKey: CONSOLE_SECRET_KEY
    smtp:
      enabled: true
      host: mailslurper
      tls: false
      port: 1025
    publicURI: https://penpot.tokens.studio
    redis:
      host: penpot-redis-master.penpot.svc.cluster.local
    postgresql:
      host: penpot-db-rw
      database: penpot
      existingSecret: db-penpot-secrets
      secretKeys:
        usernameKey: username
        passwordKey: password
  backend:
    image:
      pullPolicy: IfNotPresent
      repository: ghcr.io/tokens-studio/tokens-studio-for-penpot
      tag: 'backend-{{ .SHA }}' 
  frontend:
    labels:
      portService: tokens-studio-for-penpot
    image:
      pullPolicy: IfNotPresent
      repository: ghcr.io/tokens-studio/tokens-studio-for-penpot
      tag: 'frontend-{{ .SHA }}'
    ingress:     
      enabled: true
      annotations:
        cert-manager.io/cluster-issuer: letsencrypt-prod
      hosts:
        - host: "penpot.tokens.studio"
      tls:
        - secretName: tls-penpot
          hosts:
          - penpot.tokens.studio